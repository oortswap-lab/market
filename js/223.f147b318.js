"use strict";(self["webpackChunkOORTSwap"]=self["webpackChunkOORTSwap"]||[]).push([[223],{8223:function(e,t,a){a.r(t),a.d(t,{default:function(){return Y}});var n=a(3396),i=a(7139),o="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAABCBAMAAAAReh3bAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAYUExURUdwTBEcNRMXMhAcNBAdMxEbNBAdNBEcNasMa8oAAAAIdFJOUwBmDVo1Qh9Qg2bhnQAAAclJREFUSMeVVslygkAQHUc01zQIXLGsyjlDlck1aMozlJV4db1nKfP9YZHpNzKAvhMOz+6eXl4jBEAeN4q88yoSLTgqquB9Wt/LJTHmFjMyI4TfpCRE3ZQDXePFJDjUxJsRhLIwPPQzIxviHhM5oh4TYKTNBEcypDY8tySLMakIY2rHtjPOAo8lI7NYP6Ebabw7f2xK49+QkhH+d1/EleXndfRpfjAFQnRpFWa4Rhg6QZIzUATCCf2xNJSH2fCLPlnT697I4hYCzevkqLp1Eu6jIdS6LGEVbsKlmYKTWX0/YLhix49CcXtqRsCP6aWdv0qG4vJmHHTl0HvPsYQb1gUgwQ4RoTYXCiYbnSjgKvZ2RQbdw/g7WBkKq8wMiDSDC+hzT1/Ai2AqAnYZYsYGxBUYs3coswPSMeKs72A02DeXPODHCc9WbFR/cN1BZdAShtvBQa9+LFAOUujkPAni6ZfmC2NEtpjrVM/CA5QW1YMnShkjMm3qMEiOezXZfqEoY1wBqU0dVEMwkw4N8kuvgw5GfKPS9atlh+LGN6s2Js2Ay9uD+rZH/wa6YYtZN+Gib5sG3Stb6/NdW13IdaeFEid9o1XbB4j1C+Ufz3qMFsuZilgAAAAASUVORK5CYII=",r="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGcAAABmCAMAAADhw39uAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAACTUExURUdwTP///////////////////////////////////////////////////////////////wAAAOjo6P////MEAV1dXRoECQwBBOsJAi4uLmZmZnkSIuMSBo6OjloNGuENLH19fdMdLR8fHzY2NuDf30RERNsZHZsYLe/v77+/v9DQ0KKiorUeLo0eLTEHDpiYmMYqOsJxLB4AAAARdFJOUwAQcIDvpb8g31tAz3+Q0DCPxMoVdwAABP9JREFUaN7NmmuXojgQhkUuAmrPZJSrgkqD4+W0O///123lQkwQWiBhdt/TH+yj7dNVqVSKSs1mA7Tw5rbtutYGZLmOvZ77xkyz/JVDvr8p1/YWuhiGZ7cyOGv9Q4cl6xpyuWdBlRQhAoVFFaT3K0epWuU59IvKLChQhPCPpCS9X+gnbAWS55KvuB0T1KUoQhVDjSX5H8RbWYXeKriOJi2Ixy7HEPVScifhvhqKmVtDKFgFIbmL4cZkAyhYVYn/aoBJPjbmVqHBOuKIcPqatCLGoDEqyv6++4n3S4VG6ojDweuRZWz44LUYi0ERWaX5W8zHaJ9Jvlv1wByRmorbW5CjAQNZ9vbGdT+1YBjI/zagdWAgGgBkdYW3pw1Dg8FtP9YXcApckS4VkBrsVg5gykIbBwUdsYAXRyMGoax1iRYaF4cJYsF54SzBa3oxKGnxnKfbayynWsZLEBx1Y1AIwW02zSlD7RxUNUMBzAnQBII6aN0wZwoMMciY3hxikDm9OQ2DHNUj9BtBmvOEVFA8C2Yq6ZcoUtlDztNtPE+HOdZulz8QetCXWI8IFQET/EtJwAUlfus79S4JwQiDu62Ogujx50SVR2Fevz6dviKU/GKCz6a/uGB3f7KXF+GdMhEiYc7dVtOj/LQHxfvzLgx39HW83x96caR3OCetHSe6jXBi+G7COWPMFnT4HY7mgOMswoHCMEWyPXvOiQnnPJjz9BuCJFdv0kS2J25yVOzB5x1bngtqcLjfKEaNE1COuDyEE4scgomVOAXlrMRkQDn4m0WOmj2QEpph0MFRswfqBLZLqxfOlnBOZxp8e+BE4zn3DQu3QuZsGSf/+vrNtJM51T9c1XvOkXAgGyCRE3OOqEjiyHrHCTDHEMMaIeBsGQdnaSFfj+ZE1YZun1K2By884wjHgYI93Rxqj9w16scJxnDQcE76v+OwnYnXZ3JOrJ8jx7XMiTRyXvepwCGxTXapCidtzTtPzmPHlcv1QZJyffbNO0s5jx54HOB650x1UqhD6jxqi7W1zMH5GhclcC6ocK6EM5fPOYGzI2frdhAn6DznGuf2YRvLnFj1nEta6hCUH2LRHgoawHm1B9J1W131ymmxJxhRVzXrRIHTWb8N4twYp1H3xmx9Hg9e98bN+mAIB8oqyjHkOp6Ub3vCoXW8IifgD0Dic0n+h+5M4IQ7/JpUPCqcK3+gMwXHPXasyMlJvfPFfoMsVGRMONNkXJBLWt8pBLexFoLoOETyJitxIqHeUWiPOcJzsNh0wYVBJFYHKs+n5fM5eObDVg2nedwGc9xnn8ISa2zdfQqhe2lO2HfZCI0kYyqDbo1mrDnNCgWyOWDQJH0+HGzrv9O3fLlzcnQ2yZ+pwGvrK6favbZ87ZNDKGwSzV7bLNrvfnT2Yrv6/rOF9XfuMUjM6eorknuZrgsgU9sdA+6QW93XqLbOezPvv78HnBlLXfea5psL1KWee1qz173zTSHVVZc+986gtdI9etbzHp2F98hFKvCgiNt3nsfHcy5j7h5TMudgDJzbuA8kVTjOei1NYw6lPA4gVWS25mPoDNTC3gwhUYplzoaLTSPd34demF6VJpIYqUy/O//CKqNzT46vMGG1ZHNc96rVgZ/plUIsW4FCYpwPv12uWVrPpRVFEqT3G5sV2yxNHZN9b+fs/Jku+WbX3OBc29xgrR+eaTtLGhqWuxwyB/kvHWVjQzspOyoAAAAASUVORK5CYII=",s="data:image/png;base64,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";const d={class:"market_box wrapper"},l=(0,n._)("h1",null,"Market",-1),c={class:"tab_box flex_row_space_between"},u={class:"flex_row"},w=(0,n._)("img",{style:{width:"20px",height:"20px"},src:o,alt:""},null,-1),m=(0,n._)("span",{style:{"font-size":"15px"}},"Add",-1),p={class:"list_item_top"},g={class:"flex_row"},A={class:"flex_column item_top_box"},f=(0,n._)("img",{src:r,alt:""},null,-1),C={class:"flex_column item_top_box"},h=(0,n._)("img",{src:s,alt:""},null,-1),b=(0,n._)("h5",null,"Amount",-1),y={class:"list_item_text"},v={class:"list_item_bottom"},_={class:"list_modal_box flex_column"},x={class:"modal_top_box flex_row"},Z=(0,n._)("span",null,"CCN",-1),O=(0,n._)("img",{style:{width:"15.3px",height:"16.3px"},src:r,alt:""},null,-1),B=(0,n._)("span",null,"OORT",-1),k=(0,n._)("img",{style:{width:"15.3px",height:"16.3px"},src:s,alt:""},null,-1),S={class:"modal_bottom_box flex_row_space_between"},L=(0,n._)("span",null,"Price",-1);function N(e,t,a,o,r,s){const N=(0,n.up)("a-button"),M=(0,n.up)("a-card"),W=(0,n.up)("a-list-item"),R=(0,n.up)("a-list"),z=(0,n.up)("a-input"),U=(0,n.up)("a-form-item"),E=(0,n.up)("a-form"),T=(0,n.up)("a-space"),V=(0,n.up)("a-modal");return(0,n.wg)(),(0,n.iD)("div",d,[l,(0,n._)("div",c,[(0,n._)("div",u,[(0,n._)("div",{class:(0,i.C_)([{tab_active_item:"buy"===e.activeKey},"tab_item_box"]),onClick:t[0]||(t[0]=t=>e.changeTab("buy"))},"Buy",2),(0,n._)("div",{class:(0,i.C_)([{tab_active_item1:"sell"===e.activeKey},"tab_item_box"]),onClick:t[1]||(t[1]=t=>e.changeTab("sell"))},"Sell",2),(0,n._)("div",{class:(0,i.C_)([{tab_active_item:"my"===e.activeKey},"tab_item_box"]),onClick:t[2]||(t[2]=t=>e.changeTab("my"))},"My",2),(0,n.Wm)(N,{style:{"margin-left":"0px"},type:"text",shape:"circle",size:"large",onClick:t[3]||(t[3]=t=>e.onRefresh())},{default:(0,n.w5)((()=>[w])),_:1})]),(0,n.Wm)(N,{type:"primary",shape:"round",size:e.isMobile?"middle":"large",onClick:t[4]||(t[4]=t=>e.showAddModal())},{default:(0,n.w5)((()=>[m])),_:1},8,["size"])]),(0,n.Wm)(R,{onChange:e.tableChange,loading:e.listLoad,pagination:e.pagination,grid:{gutter:5,xs:2,sm:2,md:4,lg:4,xl:4,xxl:4},"data-source":e.listData,style:{"margin-left":"-8px","margin-right":"-8px"}},{renderItem:(0,n.w5)((({item:t})=>[(0,n.Wm)(W,{style:{padding:"0 4px"}},{default:(0,n.w5)((()=>[(0,n.Wm)(M,{class:"card_box"},{cover:(0,n.w5)((()=>[(0,n._)("div",p,[(0,n._)("div",g,[(0,n._)("div",A,[f,(0,n._)("h4",null,(0,i.zw)(e.formatAmt(t.ccnAmt)),1),(0,n._)("h5",null,(0,i.zw)(2==t.type?"Sell":"Buy"),1)]),(0,n._)("div",C,[h,(0,n._)("h4",null,(0,i.zw)(e.formatAmt(t.oortAmt)),1),b])]),(0,n._)("div",y,[(0,n._)("p",null,(0,i.zw)("1 CCN = "+e.ratio(t.ccnAmt,t.oortAmt)+" OORT"),1)])]),(0,n._)("div",v,[(0,n.Wm)(N,{type:"primary",danger:2!=t.type,shape:"round",size:"large",block:"",loading:1==t.excuting,onClick:a=>e.excute(t)},{default:(0,n.w5)((()=>[(0,n.Uk)((0,i.zw)(e.showButton(t.type)),1)])),_:2},1032,["danger","loading","onClick"])])])),_:2},1024)])),_:2},1024)])),_:1},8,["onChange","loading","pagination","data-source"]),(0,n.Wm)(V,{centered:"",width:"400px",open:e.addOpen,"onUpdate:open":t[9]||(t[9]=t=>e.addOpen=t),closable:!1},{footer:(0,n.w5)((()=>[(0,n.Wm)(T,{direction:"vertical",size:10},{default:(0,n.w5)((()=>[(0,n.Wm)(N,{type:"primary",size:"large",block:"",loading:e.subLoading,onClick:e.onBuySubmit},{default:(0,n.w5)((()=>[(0,n.Uk)((0,i.zw)(e.subBtnTitle),1)])),_:1},8,["loading","onClick"]),(0,n.Wm)(N,{size:"large",block:"",onClick:e.handleCancel},{default:(0,n.w5)((()=>[(0,n.Uk)("Cancel")])),_:1},8,["onClick"])])),_:1})])),default:(0,n.w5)((()=>[(0,n._)("div",_,[(0,n._)("div",x,[(0,n._)("div",{class:(0,i.C_)([{modal_active_item:"buy"===e.radioValue},"modal_top_item"]),onClick:t[5]||(t[5]=t=>e.radioValue="buy")},"Buy CCN",2),(0,n._)("div",{class:(0,i.C_)([{modal_active_item:"sell"===e.radioValue},"modal_top_item"]),onClick:t[6]||(t[6]=t=>e.radioValue="sell")},"Sell CCN",2)]),(0,n.Wm)(E,{ref:"addRef",model:e.addState,class:"list_form_box"},{default:(0,n.w5)((()=>[(0,n.Wm)(U,{name:"input1",rules:[{required:!0,pattern:/^\d+(\.\d{1,})$|(^[0-9]\d*$)/,message:"Please enter a number"}]},{default:(0,n.w5)((()=>[(0,n.Wm)(z,{value:e.addState.input1,"onUpdate:value":t[7]||(t[7]=t=>e.addState.input1=t),size:"large",placeholder:"Balance "+e.addState.ccnbls,onChange:e.updateInput},{prefix:(0,n.w5)((()=>[(0,n._)("span",null,(0,i.zw)("buy"===e.radioValue?"Buy":"Sell"),1)])),suffix:(0,n.w5)((()=>[Z,O])),_:1},8,["value","placeholder","onChange"])])),_:1},8,["rules"]),(0,n.Wm)(U,{name:"input2",rules:[{required:!0,pattern:/^\d+(\.\d{1,})$|(^[0-9]\d*$)/,message:"Please enter a number"}]},{default:(0,n.w5)((()=>[(0,n.Wm)(z,{value:e.addState.input2,"onUpdate:value":t[8]||(t[8]=t=>e.addState.input2=t),size:"large",placeholder:"Balance "+e.addState.oortbls,onChange:e.updateInput},{prefix:(0,n.w5)((()=>[(0,n._)("span",null,(0,i.zw)("buy"===e.radioValue?"Pay":"Get"),1)])),suffix:(0,n.w5)((()=>[B,k])),_:1},8,["value","placeholder","onChange"])])),_:1},8,["rules"])])),_:1},8,["model"]),(0,n._)("div",S,[L,(0,n._)("p",null,(0,i.zw)(e.addState.input3),1)])])])),_:1},8,["open"])])}var M=a(2693),W=a(4870),R=a(65),z=a(4180),U=a(2201),E=(0,n.aZ)({name:"Market",setup(){const e=(0,R.oR)(),t=(0,W.iH)(),a="970",i=(0,W.qj)({isMobile:(0,n.Fl)((()=>e.state.isMobile)),activeKey:"buy",radioValue:"buy",subLoading:!1,subBtnTitle:"Submit",listLoad:!1,listData:[],page:1,pagination:{current:1,total:0,pageSize:20,onChange:e=>{o.tableChange(e)}},addOpen:!1,addState:{input1:"",input2:"",input3:"",ccnbls:"0",oortbls:"0"}});(0,n.bv)((()=>{o.loadListData()}));const o={tableChange(e){i.page=e,o.loadListData()},showButton(e){return"my"==i.activeKey?"Cancel":2==e?"Buy CCN":"Sell CCN"},changeTab(t){"my"!=t||e.state.wallet_address?(i.activeKey=t,o.onRefresh()):e.dispatch("showWalletModal",!0)},ratio(e,t){return M.Z.toNumber(M.Z.div(t,e,4))},formatAmt(e){return M.Z.toNumber(M.Z.divPow(e,18,4))},onRefresh(){i.page=1,o.loadListData()},updateInput(){i.addState.input3="1 CCN = "+M.Z.toNumber(M.Z.div(i.addState.input2,i.addState.input1,4))+" OORT"},async loadListData(){var t="https://api.oortswap.com/api/limitOrders?";"buy"==i.activeKey?t+="type=2":"sell"==i.activeKey?t+="type=1":t+="account="+e.state.wallet_address,t+="&page="+i.page+"&pageSize=20&status=0";const a=await fetch(t),n=await a.json();0==n.code?(i.listData=n.data.list,i.pagination.total=n.data.count,i.pagination.current=i.page):window.notification["error"]({message:"Error",description:n.msg})},showAddModal(){e.state.wallet_address?(i.addOpen=!0,o.refreshBalance()):e.dispatch("showWalletModal",!0)},async refreshBalance(){var t=e.state.wallet_address,n=await U.Z.getCCNContract(a).methods.balanceOf(t).call();i.addState.ccnbls=M.Z.toNumber(M.Z.divPow(n,18,4));const o=await U.Z.getWeb(a).eth.getBalance(t);i.addState.oortbls=M.Z.toNumber(M.Z.divPow(o,18,4))},handleCancel(){i.addOpen=!1,t.value.resetFields()},async toBuy(){try{if("MetaMask"!=e.state.wallet_type){if(window.aleereum.networkId!=a&&0==await window.aleereum.switchNetwork(a))throw"Please switch to mainnet";window.aleereum.isConnected&&!window.aleereum.islocked||await window.aleereum.connect()}i.subLoading=!0;var n=e.state.wallet_address,o=M.Z.timesPow(i.addState.input1,18,0),r=M.Z.timesPow(i.addState.input2,18,0);const s=U.Z.getGass(a),d=await U.Z.getWeb(a).eth.getBalance(n);if(M.Z.gt(r,d))return i.subLoading=!1,void window.notification["error"]({message:"Error",description:"OORT insufficient balance"});if("MetaMask"==e.state.wallet_type)await U.Z.getLimitContract().methods.orderBuy(o,r).send({from:n,gasPrice:s,value:r});else{const e=U.Z.getWeb(a).eth.abi.encodeFunctionCall({name:"orderBuy",type:"function",inputs:[{type:"uint256",name:"ccnAmt"},{type:"uint256",name:"oortAmt"}]},[o,r]),t=await window.aleereum.send({action:"send_block",from:n,to:U.Z.getLimitContractAddr(),amount:""+r,data:e,gen_next_work:""});if(!t)throw"Buy order error"}i.subLoading=!1,i.addOpen=!1,t.value.resetFields(),window.notification["success"]({message:"Success",description:""})}catch(s){i.subLoading=!1,window.notification["error"]({message:"Error",description:JSON.stringify(s)})}},async toSell(){try{if("MetaMask"!=e.state.wallet_type){if(window.aleereum.networkId!=a&&0==await window.aleereum.switchNetwork(a))throw"Please switch to mainnet";window.aleereum.isConnected&&!window.aleereum.islocked||await window.aleereum.connect()}i.subLoading=!0;var n=e.state.wallet_address,o=M.Z.timesPow(i.addState.input1,18,0),r=M.Z.timesPow(i.addState.input2,18,0);const s=U.Z.getGass(a),d=await U.Z.getCCNContract(a).methods.balanceOf(n).call();if(M.Z.gt(o,d))return i.subLoading=!1,void window.notification["error"]({message:"Error",description:"CCN insufficient balance"});const l=await U.Z.getCCNContract(a).methods.allowance(n,U.Z.getLimitContractAddr()).call();if(M.Z.gt(o,l))if(i.subBtnTitle="Approve","MetaMask"==e.state.wallet_type)await U.Z.getCCNContractW(a).methods.approve(U.Z.getLimitContractAddr(),"115792089237316195423570985008687907853269984665640564039457584007913129639935").send({from:n,gasPrice:s});else{const e=U.Z.getWeb(a).eth.abi.encodeFunctionCall({name:"approve",type:"function",inputs:[{type:"address",name:"spender"},{type:"uint256",name:"amount"}]},[U.Z.getLimitContractAddr(),"115792089237316195423570985008687907853269984665640564039457584007913129639935"]),t=await window.aleereum.send({action:"send_block",from:n,to:U.Z.getCCNContractAddress(a),data:e,gen_next_work:""});if(!t)throw"Approve error"}if(i.subBtnTitle="Submit","MetaMask"==e.state.wallet_type)await U.Z.getLimitContract().methods.orderSell(o,r).send({from:n,gasPrice:s});else{const e=U.Z.getWeb(a).eth.abi.encodeFunctionCall({name:"orderSell",type:"function",inputs:[{type:"uint256",name:"ccnAmt"},{type:"uint256",name:"oortAmt"}]},[o,r]),t=await window.aleereum.send({action:"send_block",from:n,to:U.Z.getLimitContractAddr(),data:e,gen_next_work:""});if(!t)throw"Sell order error"}i.subLoading=!1,i.addOpen=!1,t.value.resetFields(),window.notification["success"]({message:"Success",description:""})}catch(s){i.subBtnTitle="Submit",i.subLoading=!1,window.notification["error"]({message:"Error",description:JSON.stringify(s)})}},async toCancel(t){try{t.excuting=!0;const o=U.Z.getGass(a);var n=e.state.wallet_address,i=await U.Z.getLimitContract().methods.orderState(t.orderNo).call();if(1==i)return t.excuting=!1,void window.notification["error"]({message:"Error",description:"The order has expired"});if("MetaMask"==e.state.wallet_type)await U.Z.getLimitContract().methods.orderClose(t.orderNo).send({from:n,gasPrice:o});else{const e=U.Z.getWeb(a).eth.abi.encodeFunctionCall({name:"orderClose",type:"function",inputs:[{type:"uint256",name:"no"}]},[t.orderNo]),i=await window.aleereum.send({action:"send_block",from:n,to:U.Z.getLimitContractAddr(),data:e,gen_next_work:""});if(!i)throw"Cancel error"}t.excuting=!1,window.notification["success"]({message:"Success",description:""})}catch(o){t.excuting=!1,window.notification["error"]({message:"Error",description:JSON.stringify(o)})}},async excute(t){try{if(!e.state.wallet_address)return void e.dispatch("showWalletModal",!0);if("MetaMask"!=e.state.wallet_type){if(window.aleereum.networkId!=a&&0==await window.aleereum.switchNetwork(a))throw"Please switch to mainnet";window.aleereum.isConnected&&!window.aleereum.islocked||await window.aleereum.connect()}if("my"==i.activeKey)return void o.toCancel(t);t.excuting=!0;const s=U.Z.getGass(a);var n=e.state.wallet_address,r=await U.Z.getLimitContract().methods.orderState(t.orderNo).call();if(1==r)return t.excuting=!1,void window.notification["error"]({message:"Error",description:"The order has expired"});if(2==t.type){const i=t.oortAmt,o=await U.Z.getWeb(a).eth.getBalance(n);if(M.Z.gt(i,o))return t.excuting=!1,void window.notification["error"]({message:"Error",description:"OORT insufficient balance"});if("MetaMask"==e.state.wallet_type)await U.Z.getLimitContract().methods.payOrder(t.orderNo).send({from:n,gasPrice:s,value:i});else{const e=U.Z.getWeb(a).eth.abi.encodeFunctionCall({name:"payOrder",type:"function",inputs:[{type:"uint256",name:"no"}]},[t.orderNo]),o=await window.aleereum.send({action:"send_block",from:n,to:U.Z.getLimitContractAddr(),amount:""+i,data:e,gen_next_work:""});if(!o)throw"Buy error"}}else{const o=t.ccnAmt,r=await U.Z.getCCNContract("970").methods.balanceOf(n).call();if(M.Z.gt(o,r))return t.excuting=!1,void window.notification["error"]({message:"Error",description:"CCN insufficient balance"});const d=await U.Z.getCCNContract(a).methods.allowance(n,U.Z.getLimitContractAddr()).call();if(M.Z.gt(o,d))if(i.subBtnTitle="Approve","MetaMask"==e.state.wallet_type)await U.Z.getCCNContractW(a).methods.approve(U.Z.getLimitContractAddr(),"115792089237316195423570985008687907853269984665640564039457584007913129639935").send({from:n,gasPrice:s});else{const e=U.Z.getWeb(a).eth.abi.encodeFunctionCall({name:"approve",type:"function",inputs:[{type:"address",name:"spender"},{type:"uint256",name:"amount"}]},[U.Z.getLimitContractAddr(),"115792089237316195423570985008687907853269984665640564039457584007913129639935"]),t=await window.aleereum.send({action:"send_block",from:n,to:U.Z.getCCNContractAddress(a),data:e,gen_next_work:""});if(!t)throw"Approve error"}if("MetaMask"==e.state.wallet_type)await U.Z.getLimitContract().methods.payOrder(t.orderNo).send({from:n,gasPrice:s});else{const e=U.Z.getWeb(a).eth.abi.encodeFunctionCall({name:"payOrder",type:"function",inputs:[{type:"uint256",name:"no"}]},[t.orderNo]),i=await window.aleereum.send({action:"send_block",from:n,to:U.Z.getLimitContractAddr(),data:e,gen_next_work:""});if(!i)throw"Sell error"}}t.excuting=!1,window.notification["success"]({message:"Success",description:""})}catch(s){t.excuting=!1,window.notification["error"]({message:"Error",description:JSON.stringify(s)})}},onBuySubmit(){t.value.validate().then((()=>{"buy"==i.radioValue?z.Z.confirm({title:"Confirm",content:"Are you sure pay "+i.addState.input2+" OORT to buy "+i.addState.input1+" CCN?",onOk(){o.toBuy()},onCancel(){}}):z.Z.confirm({title:"Confirm",content:"Are you sure sell "+i.addState.input1+" CCN to get "+i.addState.input2+" OORT?",onOk(){o.toSell()},onCancel(){}})})).catch((e=>{console.log("error",e)}))}};return{addRef:t,...(0,W.BK)(i),...o}}}),T=a(89);const V=(0,T.Z)(E,[["render",N]]);var Y=V}}]);